{
    "version": "8.9.1",
    "description": "1Password desktop app for Windows.",
    "homepage": "https://1password.com",
    "license": {
        "identifier": "Proprietary",
        "url": "https://1password.com/legal/terms-of-service/"
    },
    "notes": "This installer requires administrative privileges to install properly.",
    "architecture": {
        "64bit": {
            "url": "https://downloads.1password.com/win/1PasswordSetup-8.9.1.exe#/dl.exe",
        }
    },
    "installer": {
        "script": [
            "Invoke-ExternalCommand -FilePath \"$dir\\dl.exe\" -ArgumentList '/VERYSILENT /NORESTART /SUPPRESSMSGBOXES' -RunAs | Out-Null",
            "if (!(Test-Path \"$env:LOCALAPPDATA\\1Password\\app\\8\\1Password.exe\")) {",
            "    abort 'Error: Could not find 1Password.exe after installation'",
            "}",
            "New-Item -ItemType Directory -Force -Path \"$dir\\bin\" | Out-Null",
            "New-Item -ItemType SymbolicLink -Target \"$env:LOCALAPPDATA\\1Password\\app\\8\\1Password.exe\" -Path \"$dir\\bin\\1Password.exe\" | Out-Null"
        ]
    },
    "uninstaller": {
        "script": [
            "$uninstaller = Get-ChildItem -Path \"$env:PROGRAMDATA\\Package Cache\\*\" -Filter \"1PasswordSetup*.exe\" -Recurse | Sort-Object -Property LastWriteTime -Descending | Select-Object -First 1",
            "if ($uninstaller) {",
            "    Invoke-ExternalCommand -FilePath $uninstaller.FullName -ArgumentList '/VERYSILENT /NORESTART /SUPPRESSMSGBOXES' -RunAs | Out-Null",
            "} else {",
            "    Write-Warning \"Could not find 1Password uninstaller. The application may need to be uninstalled manually.\"",
            "}"
        ]
    },
    "bin": "bin\\1Password.exe",
    "shortcuts": [
        [
            "bin\\1Password.exe",
            "1Password"
        ]
    ],
    "checkver": {
        "url": "https://releases.1password.com/windows/",
        "regex": "1Password Setup ([\\d.]+)\\.exe"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://downloads.1password.com/win/1PasswordSetup-$version.exe#/dl.exe"
            }
        }
    }
}
